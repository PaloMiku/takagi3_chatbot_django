{% extends 'base.html' %}
{% load static %}

{% block title %}重置密码{% endblock %}

{% block bootstrap_css %}{% endblock %}
{% block bootstrap_scripts %}{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
{% endblock %}

{% block content %}
<div class="auth-wrapper">
  <div class="auth-card">
    <div class="auth-header">
      <h1 class="auth-title">重置密码</h1>
    </div>

    {% if ok %}
      <div class="alert alert-success">密码已重置并已登录。</div>
      <a class="btn btn-primary" href="{% url 'chatbot' %}" style="width: 100%; margin-top: 1rem;">前往聊天</a>
    {% else %}
      {% if error %}<div class="alert">{{ error }}</div>{% endif %}
      <form method="post">
        {% csrf_token %}
        <div class="form-group">
          <label for="email">邮箱</label>
          <input type="email" class="form-control" id="email" name="email" value="{{ email }}" required readonly>
        </div>
        <div class="form-group">
          <label for="code">验证码</label>
          <input type="text" class="form-control" id="code" name="code" required>
        </div>
        <div class="form-group">
          <label for="new_password1">新密码</label>
          <input type="password" class="form-control" id="new_password1" name="new_password1" required>
        </div>
        <div class="form-group">
          <label for="new_password2">再次输入新密码</label>
          <input type="password" class="form-control" id="new_password2" name="new_password2" required>
        </div>
        <button type="submit" class="btn btn-primary">重置密码</button>
        <div class="switch-link">
          <a href="{% url 'login' %}">返回登录</a>
        </div>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
